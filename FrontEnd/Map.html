<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WayStream - Explore Destinations</title>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1a3c87; /* Deep, professional blue */
            --primary-dark: #152e6e; /* Darker shade for hover */
            --secondary: #f4a261; /* Warm accent for CTAs */
            --accent: #2a9d8f; /* Teal for secondary highlights */
            --light: #ffffff;
            --dark: #1a1a1a;
            --gray: #f8f9fa;
            --dark-gray: #6b7280;
            --transition: all 0.3s ease;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --shadow-hover: 0 6px 20px rgba(0, 0, 0, 0.15);
            --navbar-height: 80px;
            --navbar-height-mobile: 70px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            color: var(--dark);
            line-height: 1.7;
            background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)),
                        url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80') no-repeat center center/cover;
            background-attachment: fixed;
            padding-top: var(--navbar-height);
        }

        h1, h2, h3, h4 {
            font-family: 'Playfair Display', serif;
            font-weight: 600;
            color: var(--primary-dark);
        }

        /* Navbar Styles */
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1.2rem 5%;
            background: rgba(26, 60, 135, 0.95);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow);
            backdrop-filter: blur(5px);
        }

        .logo {
            font-size: 2rem;
            font-weight: 700;
            color: var(--light);
            text-decoration: none;
            display: flex;
            align-items: center;
        }

        .logo i {
            margin-right: 0.6rem;
            color: var(--secondary);
            font-size: 1.8rem;
        }

        .nav-links {
            display: flex;
            gap: 2.5rem;
            align-items: center;
        }

        .nav-links a {
            color: var(--light);
            text-decoration: none;
            font-size: 1rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            transition: var(--transition);
            position: relative;
            padding: 0.5rem 0;
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background-color: var(--secondary);
            transition: var(--transition);
        }

        .nav-links a:hover::after {
            width: 100%;
        }

        .nav-links a:hover {
            color: var(--secondary);
            transform: translateY(-2px);
        }

        .hidden {
            display: none !important;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            color: var(--light);
            font-size: 1.8rem;
            cursor: pointer;
        }

        /* Main Content */
        .section {
            padding: 5rem 5%;
            background: rgba(255, 255, 255, 0.95);
            margin: 3rem auto;
            border-radius: 15px;
            max-width: 1200px;
            box-shadow: var(--shadow);
        }

        .section-title {
            text-align: center;
            margin-bottom: 3.5rem;
        }

        .section-title h2 {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 0.8rem;
        }

        .section-title p {
            font-size: 1.1rem;
            color: var(--dark-gray);
            max-width: 800px;
            margin: 0 auto;
        }

        /* Search Controls Outside Map */
        .search-controls-outside {
            background: var(--light);
            padding: 2rem;
            border-radius: 10px;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .search-controls-outside h3 {
            font-family: 'Inter', sans-serif;
            color: var(--primary-dark);
            font-size: 1.5rem;
            margin-bottom: 1.5rem;
            font-weight: 600;
        }

        .search-controls-outside .inputs {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 1.5rem;
        }

        .search-controls-outside input {
            padding: 12px 15px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            transition: var(--transition);
            background: var(--light);
        }

        .search-controls-outside input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(26, 60, 135, 0.1);
        }

        .search-controls-outside .get-directions-btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: var(--light);
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            width: fit-content;
            margin: 0 auto;
            display: block;
        }

        .search-controls-outside .get-directions-btn:hover {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary));
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .search-controls-outside .get-directions-btn.loading {
            position: relative;
            pointer-events: none;
        }

        .search-controls-outside .get-directions-btn.loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        /* AI Place Analyzer */
        .ai-tools-container {
            background: var(--light);
            padding: 2.5rem;
            border-radius: 12px;
            box-shadow: var(--shadow);
            max-width: 600px;
            margin: 2rem auto;
            animation: fadeIn 0.6s ease;
        }

        .ai-tools-container h3 {
            font-family: 'Inter', sans-serif;
            font-size: 1.5rem;
            color: var(--primary-dark);
            margin-bottom: 1rem;
            font-weight: 600;
            text-align: center;
        }

        .ai-tools-container h3 i {
            margin-right: 0.5rem;
            color: var(--primary);
        }

        .ai-tools-container p {
            font-size: 1rem;
            color: var(--dark-gray);
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .ai-analyze-btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: var(--light);
            border: none;
            border-radius: 8px;
            padding: 0.9rem 1.5rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .ai-analyze-btn:hover {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary));
            transform: translateY(-2px);
            box-shadow: var(--shadow-hover);
        }

        .ai-analyze-btn:disabled {
            background: var(--dark-gray);
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Map Container and Nearby Places */
        .map-and-places {
            display: flex;
            gap: 2rem;
            align-items: flex-start;
        }

        .map-container {
            position: relative;
            width: 70%;
            height: 80vh;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow-hover);
            background-color: var(--light);
        }

        #explore-map {
            width: 100%;
            height: 100%;
        }

        /* Distance Display */
        .distance-display {
            margin-top: 1.5rem;
            text-align: center;
            background: var(--light);
            padding: 1rem;
            border-radius: 8px;
            box-shadow: var(--shadow);
            max-width: 300px;
            margin-left: auto;
            margin-right: auto;
        }

        .distance-display p {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--primary);
        }

        .distance-display p span {
            color: var(--dark);
            font-weight: 500;
        }

        /* Nearby Places */
        .nearby-places {
            width: 30%;
            background: var(--light);
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: var(--shadow);
            height: 80vh;
            overflow-y: auto;
        }

        .nearby-places h3 {
            font-family: 'Inter', sans-serif;
            font-size: 1.4rem;
            color: var(--primary-dark);
            margin-bottom: 1.5rem;
            font-weight: 600;
        }

        .place {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid #e5e7eb;
        }

        .place:last-child {
            border-bottom: none;
        }

        .place-info h4 {
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 0.3rem;
        }

        .place-info p {
            font-size: 0.9rem;
            color: var(--dark-gray);
        }

        .place-rating {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .place-rating .stars {
            color: #ffd700; /* Gold for stars */
            font-size: 1rem;
        }

        .place-rating .rating-value {
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--dark);
        }

        .no-places {
            text-align: center;
            padding: 2rem;
            color: var(--dark-gray);
        }

        /* Current Location Button */
        .current-location-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 1000;
            background: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            box-shadow: 0 1px 5px rgba(0,0,0,0.4);
            cursor: pointer;
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Footer Styles */
        footer {
            background: var(--primary-dark);
            color: var(--light);
            padding: 5rem 5% 3rem;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 4rem;
            max-width: 1200px;
            margin: 0 auto 3rem;
        }

        .footer-col h3 {
            font-size: 1.6rem;
            margin-bottom: 1.5rem;
            position: relative;
            padding-bottom: 0.6rem;
        }

        .footer-col h3::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 60px;
            height: 3px;
            background: var(--secondary);
        }

        .footer-col p {
            margin-bottom: 1.2rem;
            opacity: 0.85;
            font-size: 0.95rem;
        }

        .footer-links li {
            margin-bottom: 1rem;
            list-style: none;
        }

        .footer-links a {
            color: var(--light);
            text-decoration: none;
            opacity: 0.85;
            font-size: 0.95rem;
            transition: var(--transition);
        }

        .footer-links a:hover {
            opacity: 1;
            color: var(--secondary);
            padding-left: 8px;
        }

        .social-links {
            display: flex;
            gap: 1.2rem;
        }

        .social-links a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 45px;
            height: 45px;
            background: rgba(255, 255, 255, 0.15);
            color: var(--light);
            border-radius: 50%;
            transition: var(--transition);
        }

        .social-links a:hover {
            background: var(--secondary);
            transform: translateY(-4px);
        }

        .newsletter-form {
            display: flex;
        }

        .newsletter-form input {
            flex-grow: 1;
            padding: 12px 15px;
            border: none;
            border-radius: 8px 0 0 8px;
            font-size: 1rem;
            background: var(--light);
        }

        .newsletter-form button {
            padding: 12px 20px;
            border: none;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: var(--light);
            border-radius: 0 8px 8px 0;
            cursor: pointer;
            transition: var(--transition);
            font-size: 1rem;
            font-weight: 600;
        }

        .newsletter-form button:hover {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary));
            transform: translateY(-2px);
        }

        /* Responsive Design */
        @media (max-width: 992px) {
            .section-title h2 {
                font-size: 2.5rem;
            }

            .section-title p {
                font-size: 1rem;
            }

            .map-and-places {
                flex-direction: column;
            }

            .map-container, .nearby-places {
                width: 100%;
            }

            .nearby-places {
                height: auto;
                max-height: 50vh;
            }
        }

        @media (max-width: 768px) {
            body {
                padding-top: var(--navbar-height-mobile);
            }

            .navbar {
                padding: 1rem 5%;
                height: var(--navbar-height-mobile);
            }

            .logo {
                font-size: 1.8rem;
            }

            .nav-links {
                position: fixed;
                top: var(--navbar-height-mobile);
                left: -100%;
                width: 100%;
                height: calc(100vh - var(--navbar-height-mobile));
                background: var(--primary-dark);
                flex-direction: column;
                align-items: center;
                justify-content: flex-start;
                padding-top: 4rem;
                gap: 3rem;
                transition: var(--transition);
                z-index: 999;
            }

            .nav-links.active {
                left: 0;
            }

            .mobile-menu-btn {
                display: block;
                z-index: 1001;
            }

            .section {
                padding: 3rem 5%;
                margin: 1.5rem;
            }

            .section-title h2 {
                font-size: 2rem;
            }

            .section-title p {
                font-size: 0.95rem;
            }

            .map-container {
                height: 70vh;
            }

            .search-controls-outside,
            .ai-tools-container {
                padding: 1.5rem;
            }

            .footer-content {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .footer-col h3::after {
                left: 50%;
                transform: translateX(-50%);
            }

            .social-links {
                justify-content: center;
            }

            .newsletter-form {
                max-width: 400px;
                margin: 0 auto;
            }
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 1s ease forwards;
            opacity: 0;
            transform: translateY(30px);
        }

        .delay-1 {
            animation-delay: 0.3s;
        }
    </style>
</head>
<body>
    <!-- Header / Navbar -->
    <header class="navbar">
        <a href="index.html" class="logo">
            <i class="fas fa-route"></i> WayStream
        </a>
        <button class="mobile-menu-btn" id="mobileMenuBtn">
            <i class="fas fa-bars"></i>
        </button>
        <nav class="nav-links" id="navLinks">
            <a href="index.html">Home</a>
            <a href="Review.html" class="protected-link">Reviews</a>
            <a href="Map.html">Map</a>
            <a href="Contact.html" class="protected-link">Contact</a>
            <a href="Register.html" class="login-btn" id="registerLink">Login/Register</a>
            <a href="#" class="login-btn hidden" id="logoutLink">Logout</a>
        </nav>
    </header>

    <!-- Main Content -->
    <main>
        <!-- Map Section -->
        <section class="section fade-in delay-1">
            <div class="section-title">
                <h2>Interactive Travel Map</h2>
                <p>Enter start and destination points to visualize your route and distance.</p>
            </div>

            <!-- Search Controls Outside Map -->
            <div class="search-controls-outside">
                <h3>Get Directions</h3>
                <div class="inputs">
                    <label for="start-input" class="hidden">Start Location</label>
                    <input type="text" id="start-input" placeholder="Enter start location..." value="" aria-label="Start Location">
                    <label for="destination-input" class="hidden">Destination Location</label>
                    <input type="text" id="destination-input" placeholder="Enter destination..." value="" aria-label="Destination Location">
                </div>
                <button class="get-directions-btn" id="getDirectionsBtn">Get Directions</button>
            </div>

            <!-- Map and Nearby Places -->
            <div class="map-and-places">
                <!-- Map Container -->
                <div class="map-container">
                    <div id="explore-map"></div>
                    <button class="current-location-btn" id="currentLocationBtn" title="Use my current location">
                        <i class="fas fa-location-arrow"></i>
                    </button>
                </div>

                <!-- Nearby Places -->
                <div class="nearby-places" id="places-container">
                    <h3>Nearby Places</h3>
                    <div class="no-places">
                        <p>Search for directions to see nearby places at your destination</p>
                    </div>
                </div>
            </div>

            <!-- Distance Display -->
            <div class="distance-display" id="distanceDisplay">
                <p>Distance and Time <br> <span id="distanceValue">N/A</span></p>
            </div>

            <!-- AI Place Analyzer -->
            <div class="ai-tools-container">
                <h3><i class="fas fa-robot"></i> AI Trip Analyzer</h3>
                <p>Analyze your trip based on the start and destination locations above.</p>
                <button type="button" class="ai-analyze-btn" id="aiAnalyzeBtn">
                    <i class="fas fa-search-location"></i> Analyze Trip
                </button>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-col">
                <h3>WayStream</h3>
                <p>Transforming travel since 2015 with curated, sustainable journeys across the globe.</p>
                <div class="social-links">
                    <a href="#" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                    <a href="#" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    <a href="#" aria-label="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
            <div class="footer-col">
                <h3>Quick Links</h3>
                <ul class="footer-links">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="Review.html" class="protected-link">Reviews</a></li>
                    <li><a href="Map.html">Map</a></li>
                    <li><a href="Contact.html" class="protected-link">Contact</a></li>
                    <li><a href="Login.html" id="footerLoginLink">Login</a></li>
                    <li><a href="Register.html" id="footerRegisterLink">Register</a></li>
                    <li><a href="#" class="hidden" id="footerLogoutLink">Logout</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h3>Newsletter</h3>
                <p>Subscribe for exclusive travel tips and offers.</p>
                <form class="newsletter-form" id="newsletterForm">
                    <label for="newsletter-email" class="hidden">Email</label>
                    <input type="email" id="newsletter-email" placeholder="Your Email" required>
                    <button type="submit">Subscribe</button>
                </form>
            </div>
        </div>
        <div class="footer-bottom">
            <p>© <span id="currentYear"></span> WayStream Travel. All Rights Reserved.</p>
        </div>
    </footer>

    <!-- Google Maps API -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCQ8njadJwk5j3mMOh1CwKiXbho7zmsJ5A&libraries=places"></script>
    <!-- External Analysis Script -->
    <script src="Mscript.js"></script>
    <!-- Main Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Set current year in footer
            document.getElementById('currentYear').textContent = new Date().getFullYear();
            
            // Mobile menu toggle
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const navLinks = document.getElementById('navLinks');
            
            if (mobileMenuBtn && navLinks) {
                mobileMenuBtn.addEventListener('click', function() {
                    navLinks.classList.toggle('active');
                    this.querySelector('i').classList.toggle('fa-bars');
                    this.querySelector('i').classList.toggle('fa-times');
                });
            }
            
            // Initialize map
            let map;
            let directionsService;
            let directionsRenderer;
            let markers = [];
            let autocompleteStart;
            let autocompleteDest;
            
            function initMap() {
                // Create map centered on a default location (Hyderabad)
                map = new google.maps.Map(document.getElementById('explore-map'), {
                    center: { lat: 17.3850, lng: 78.4867 },
                    zoom: 12
                });
                
                // Initialize directions service and renderer
                directionsService = new google.maps.DirectionsService();
                directionsRenderer = new google.maps.DirectionsRenderer({
                    map: map,
                    suppressMarkers: false,
                    polylineOptions: {
                        strokeColor: '#1a3c87',
                        strokeOpacity: 0.7,
                        strokeWeight: 5
                    }
                });
                
                // Initialize autocomplete for input fields
                autocompleteStart = new google.maps.places.Autocomplete(
                    document.getElementById('start-input'),
                    { types: ['geocode'] }
                );
                
                autocompleteDest = new google.maps.places.Autocomplete(
                    document.getElementById('destination-input'),
                    { types: ['geocode'] }
                );
                
                // Add current location button functionality
                document.getElementById('currentLocationBtn').addEventListener('click', function() {
                    if (navigator.geolocation) {
                        const btn = this;
                        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
                        
                        navigator.geolocation.getCurrentPosition(
                            function(position) {
                                const pos = {
                                    lat: position.coords.latitude,
                                    lng: position.coords.longitude
                                };
                                
                                // Center map on current location
                                map.setCenter(pos);
                                map.setZoom(15);
                                
                                // Add marker
                                clearMarkers();
                                addMarker(pos, 'Your Location');
                                
                                // Update start input with address
                                const geocoder = new google.maps.Geocoder();
                                geocoder.geocode({ location: pos }, function(results, status) {
                                    if (status === 'OK' && results[0]) {
                                        document.getElementById('start-input').value = results[0].formatted_address;
                                    }
                                });
                                
                                btn.innerHTML = '<i class="fas fa-location-arrow"></i>';
                            },
                            function(error) {
                                console.error('Error getting location:', error);
                                alert('Unable to get your location. Please check your browser permissions.');
                                btn.innerHTML = '<i class="fas fa-location-arrow"></i>';
                            }
                        );
                    } else {
                        alert('Geolocation is not supported by your browser.');
                    }
                });
            }
            
            // Initialize the map
            initMap();
            
            // Function to add a marker
            function addMarker(location, title) {
                const marker = new google.maps.Marker({
                    position: location,
                    map: map,
                    title: title
                });
                markers.push(marker);
                return marker;
            }
            
            // Function to clear all markers
            function clearMarkers() {
                for (let i = 0; i < markers.length; i++) {
                    markers[i].setMap(null);
                }
                markers = [];
            }
            
            // Function to calculate and display route
            function calculateAndDisplayRoute() {
                const startInput = document.getElementById('start-input').value.trim();
                const destinationInput = document.getElementById('destination-input').value.trim();
                
                if (!startInput || !destinationInput) {
                    alert('Please enter both start and destination locations.');
                    return;
                }
                
                const btn = document.getElementById('getDirectionsBtn');
                btn.classList.add('loading');
                btn.disabled = true;
                
                // Clear previous markers
                clearMarkers();
                
                // Create request for directions
                const request = {
                    origin: startInput,
                    destination: destinationInput,
                    travelMode: 'DRIVING'
                };
                
                // Get directions
                directionsService.route(request, function(result, status) {
                    if (status === 'OK') {
                        // Display route
                        directionsRenderer.setDirections(result);
                        
                        // Get distance and duration
                        const route = result.routes[0].legs[0];
                        const distance = route.distance.text;
                        const duration = route.duration.text;
                        
                        // Update distance display
                        document.getElementById('distanceValue').textContent = 
                            `${distance} (approx. ${duration})`;
                        
                        // Add markers for start and end points
                        addMarker(route.start_location, 'Start: ' + startInput);
                        addMarker(route.end_location, 'Destination: ' + destinationInput);
                        
                        // Show nearby places
                        showNearbyPlaces(route.end_location);
                    } else {
                        alert('Unable to find a route. Please check your locations and try again.');
                    }
                    btn.classList.remove('loading');
                    btn.disabled = false;
                });
            }
            
            // Function to show nearby places
            function showNearbyPlaces(location) {
                const placesContainer = document.getElementById('places-container');
                
                // In a real app, you would use the Places API here
                // For demo purposes, we'll use dummy data
                const dummyPlaces = [
                    { name: 'Central Restaurant', rating: 4.5, type: 'Restaurant' },
                    { name: 'Grand Hotel', rating: 4.2, type: 'Hotel' },
                    { name: 'City Museum', rating: 4.7, type: 'Attraction' },
                    { name: 'Cozy Cafe', rating: 4.3, type: 'Cafe' },
                    { name: 'Sunset Restaurant', rating: 4.1, type: 'Restaurant' },
                    { name: 'Historic Tower', rating: 4.8, type: 'Attraction' }
                ];
                
                let placesHTML = '<h3>Nearby Places</h3>';
                
                dummyPlaces.forEach(place => {
                    const stars = '★'.repeat(Math.floor(place.rating)) + 
                                  (place.rating % 1 >= 0.5 ? '½' : '');
                    
                    placesHTML += `
                        <div class="place">
                            <div class="place-info">
                                <h4>${place.name}</h4>
                                <p>${place.type}</p>
                            </div>
                            <div class="place-rating">
                                <span class="stars">${stars}</span>
                                <span class="rating-value">${place.rating}</span>
                            </div>
                        </div>
                    `;
                });
                
                placesContainer.innerHTML = placesHTML;
            }
            
            // Get Directions button click handler
            document.getElementById('getDirectionsBtn').addEventListener('click', function() {
                calculateAndDisplayRoute();
            });
            
            // AI Trip Analyzer
            async function handleAiAnalyzeClick() {
                const start = document.getElementById('start-input').value.trim();
                const destination = document.getElementById('destination-input').value.trim();
                
                if (!start || !destination) {
                    alert('Please enter both start and destination locations above.');
                    return;
                }

                const aiAnalyzeBtn = document.getElementById('aiAnalyzeBtn');
                aiAnalyzeBtn.disabled = true;

                try {
                    // Call external script function
                    if (typeof handleAnalyzePlace === 'function') {
                        await handleAnalyzePlace(start, destination);
                    } else {
                        throw new Error('Analysis function not found. Please ensure Mscript.js is loaded correctly.');
                    }
                } catch (error) {
                    alert(`Error: ${error.message}`);
                } finally {
                    aiAnalyzeBtn.disabled = false;
                }
            }
            
            // Login/logout functionality
            function isLoggedIn() {
                return localStorage.getItem('waystreamLoggedIn') === 'true';
            }
            
            function updateNavUI() {
                const loggedIn = isLoggedIn();
                document.getElementById('registerLink').classList.toggle('hidden', loggedIn);
                document.getElementById('logoutLink').classList.toggle('hidden', !loggedIn);
                document.getElementById('footerLoginLink').classList.toggle('hidden', loggedIn);
                document.getElementById('footerRegisterLink').classList.toggle('hidden', loggedIn);
                document.getElementById('footerLogoutLink').classList.toggle('hidden', !loggedIn);
            }
            
            document.getElementById('logoutLink').addEventListener('click', function(e) {
                e.preventDefault();
                localStorage.removeItem('waystreamLoggedIn');
                localStorage.removeItem('waystreamUsername');
                alert('You have been logged out.');
                updateNavUI();
                window.location.href = 'index.html';
            });
            
            // Newsletter form submission
            document.getElementById('newsletterForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const email = document.getElementById('newsletter-email').value;
                if (email) {
                    alert('Thank you for subscribing!');
                    this.reset();
                }
            });
            
            // Animate elements on scroll
            const animateOnScroll = () => {
                const elements = document.querySelectorAll('.fade-in');
                const screenPosition = window.innerHeight / 1.3;
                elements.forEach(element => {
                    if (window.getComputedStyle(element).opacity === '1') return;
                    const elementPosition = element.getBoundingClientRect().top;
                    if (elementPosition < screenPosition) {
                        element.style.opacity = '1';
                        element.style.transform = 'translateY(0)';
                    }
                });
            };
            
            // Initial setup
            updateNavUI();
            animateOnScroll();
            window.addEventListener('scroll', animateOnScroll);
            
            // Initialize AI Trip Analyzer
            document.getElementById('aiAnalyzeBtn').addEventListener('click', handleAiAnalyzeClick);
        });
    </script>
</body>
</html>
